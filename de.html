<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vercel Ajan Testi</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #121212; color: #e0e0e0; }
        .container { max-width: 800px; margin: auto; background: #1e1e1e; padding: 25px; border-radius: 8px; border: 1px solid #333; }
        h1 { color: #bb86fc; }
        textarea { width: 100%; height: 400px; font-family: monospace; font-size: 14px; padding: 10px; resize: vertical; border: 1px solid #444; background-color: #121212; color: #03dac6; border-radius: 4px; box-sizing: border-box; }
        button { padding: 12px 20px; margin: 10px 5px 10px 0; border: none; background-color: #bb86fc; color: #121212; border-radius: 4px; cursor: pointer; font-size: 16px; font-weight: bold; }
        .controls { margin-bottom: 20px; background-color: #2c2c2c; padding: 15px; border-radius: 6px; }
        label { margin-right: 10px; font-weight: bold; }
        input, select { padding: 8px; border-radius: 4px; border: 1px solid #555; margin-right: 15px; background-color: #333; color: #e0e0e0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Vercel Ajan Testi (Python)</h1>
        <p>Bu sayfa, Vercel'deki Python fonksiyonuna istek gönderir. Fonksiyon, CoinAnk'tan likidasyon verisini çeker ve buraya yollar.</p>
        
        <div class="controls">
            <label for="symbol">Sembol:</label>
            <input type="text" id="symbol" value="BTCUSDT">
            <button onclick="fetchData()">Veriyi Çek</button>
        </div>

        <textarea id="result" readonly placeholder="Veri çekmek için butona tıklayın..."></textarea>
    </div>

    <script>
        function fetchData() {
            const resultTextarea = $('#result');
            resultTextarea.val('Vercel ajanıyla bağlantı kuruluyor...');

            const symbol = $('#symbol').val().toUpperCase();
            
            // SENİN VERCEL PROJENİN URL'Sİ
            const vercelApiUrl = `https://coinank-api.vercel.app/api/fetchData?symbol=${symbol}`;

            console.log(`İstek gönderiliyor: ${vercelApiUrl}`);

            $.ajax({
                url: vercelApiUrl,
                method: 'GET',
                timeout: 15000, // 15 saniye bekle
                success: function (response) {
                    console.log("Başarılı Cevap:", response);
                    if (response && response.success) {
                        resultTextarea.val("---- BAŞARILI ----\n\n" + JSON.stringify(response.data, null, 2));
                    } else {
                        resultTextarea.val("---- API HATASI ----\n\nCoinAnk'tan hata mesajı alındı:\n\n" + JSON.stringify(response, null, 2));
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.error('AJAX Hatası:', jqXHR);
                    let errorMessage = `HATA: Vercel Ajanı Cevap Vermedi!\n\n` +
                                       `Durum: ${textStatus}\n` +
                                       `HTTP Status Kodu: ${jqXHR.status}\n\n` +
                                       `Sunucu Cevabı:\n${jqXHR.responseText}`;
                    resultTextarea.val(errorMessage);
                }
            });
        }
    </script>
</body>
</html>